<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kalendarz Adwentowy â€“ Quiz</title>
<style>
body { font-family: Arial, sans-serif; background: linear-gradient(#ffefef,#ffeaea); margin:0; padding:20px; display:flex; flex-direction:column; align-items:center; overflow-x:hidden;}
h1 { color:#d62828; margin-bottom:10px; animation:pulse 2s infinite; }
@keyframes pulse { 0% { transform: scale(1);} 50% { transform: scale(1.05);} 100% { transform: scale(1);} }
.day-box { width:90%; max-width:600px; background:white; padding:20px; margin:15px 0; border-radius:12px; box-shadow:0 0 15px rgba(0,0,0,0.15); position:relative; overflow:hidden;}
.locked { opacity:0.5; pointer-events:none; }
button { margin-top:10px; padding:8px 14px; border:none; background:#d62828; color:white; border-radius:6px; cursor:pointer; }
button:hover { background:#a71c1c; }
.password { margin-top:10px; font-weight:bold; color:green; }
.rating { display:flex; gap:5px; font-size:26px; cursor:pointer; user-select:none; margin-top:10px; }
.star { color:#ccc; transition:color 0.2s; }
.star.selected { color:gold; }
.star:hover, .star:hover ~ .star { color:#ccc; }
.rating:hover .star { color:gold; }
.rating .star:hover ~ .star { color:#ccc; }

/* Falling snow & hearts */
.snowflake, .heart { position:fixed; top:-10px; font-size:1.2em; animation:fall linear infinite; pointer-events:none; }
.snowflake { color:white; }
.heart { color:red; filter:blur(1.1px);}
@keyframes fall { 0% { transform:translateY(0); opacity:1;} 100% { transform:translateY(100vh); opacity:0;} }
</style>
</head>
<body>
<h1>ğŸ„ Adwentowy Quiz dla Alicji â¤ï¸</h1>
<p>Odpowiedz na pytanie dnia, aby dostaÄ‡ hasÅ‚o (numer paczki) ğŸ</p>
<p>Musisz prÃ³bowaÄ‡ rÃ³Å¼nych form danego sÅ‚owa</p>
<p>POLSKIE ZNAKI !!! </p>
<p>PRZEPRASZAM za moje umiejÄ™tnoÅ›ci pakowania</p>
<p style="color:red;">ze wszystkimi problemami prosze pisac do: RafaÅ‚ Kwiek</p>
<script>
// KONFIGURACJA
const sheetURL = "https://script.google.com/macros/s/AKfycbwLIlDl4GD2NGsis-8VY8qb9RHrPS9zlMySLgdF3BXtN3uanpE2SSXj2RlF3HuZK3-ujw/exec"; // TwÃ³j Web App
const params = new URLSearchParams(window.location.search);
const test = params.get('test') === '1';
const dzis = test ? new Date(2025, 11, 25) : new Date();
let wybraneOceny = {};

// DANE 24 DNI
const dane = [
{dzien:1,pytanie:"gdzie sie poznaliÅ›my?",odp:"szkoÅ‚a muzyczna",haslo:"Paczka 1602"},
{dzien:2,pytanie:"Jakim pieszczotliwym okreÅ›leniem najczÄ™Å›ciej CiÄ™ nazywam?",odp:"Å¼uczku",haslo:"Paczka 5100"},
{dzien:3,pytanie:"jaki kolor oczu chciaÅ‚abyÅ› Å¼eby miaÅ‚ twÃ³j chÅ‚opak?:(",odp:"niebieski",haslo:"Paczka 5118"},
{dzien:4,pytanie:"Jakiego psa chcesz kiedyÅ› mieÄ‡?",odp:"parÃ³wa",haslo:"Paczka 0020"},
{dzien:5,pytanie:"TwÃ³j ulubiony napÃ³j gazowany",odp:"cola zero",haslo:"Paczka 0005"},
{dzien:6,pytanie:"Twoj ulubiony energetyk",odp:"redbull",haslo:"Paczka 0006"},
{dzien:7,pytanie:"Co to?( zaiebierzesz sobie w tym zimowÄ… herbatke do pracy i jest rÃ³Å¼owe?",odp:"termos",haslo:"Paczka 1081"},
{dzien:8,pytanie:"Kto siÄ™ czÄ™Å›ciej denerwuje?(imiÄ™)",odp:"alicja",haslo:"Paczka 0062"},
{dzien:9,pytanie:"Moje auto marzenie?",odp:"bmw f80",haslo:"Paczka 0126"},
{dzien:10,pytanie:"W czym najlepiej wedÅ‚ug mnie wyglÄ…dasz?",odp:"bez niczego",haslo:"Paczka 6202"},
{dzien:11,pytanie:"Co bÄ™dziemy taÅ„czyÄ‡ podczas naszego 1 taÅ„ca? ... lub ... (wszytskie opcje)",odp:"tango lub walca",haslo:"Paczka 0621"},
{dzien:12,pytanie:"Nasze najwaÅ¼niejsze wspomienie?",odp:"oÅ›wiadczyny",haslo:"Paczka 1500"},
{dzien:13,pytanie:"Jak siÄ™ poznaliÅ›my co ci siÄ™ we mnie podobaÅ‚o?",odp:"nic",haslo:"Paczka 2200"},
{dzien:14,pytanie:"Jakie kwiaty najczÄ™Å›ciej ode mnie dostajesz?",odp:"rÃ³Å¼e",haslo:"Paczka 2000"},
{dzien:15,pytanie:"Jak nazywa siÄ™ nasze ulubione miejsce na rowery?",odp:"velodunajec",haslo:"Paczka 0660"},
{dzien:16,pytanie:"MÃ³j ulubiony fast food",odp:"burger",haslo:"Paczka 0221"},
{dzien:17,pytanie:"Jaki projekt domu siÄ™ nam podoba?",odp:"willa parkowa 9",haslo:"Paczka 2605"},
{dzien:18,pytanie:"Czego nie lubisz na swojej twarzy?",odp:"pryszczy",haslo:"Paczka 2606"},
{dzien:19,pytanie:"Twoje ulubione Å›wiÄ™to w roku?",odp:"boÅ¼e narodzenie",haslo:"Paczka 2502"},
{dzien:20,pytanie:"Co oboje lubimy gdy nam sie to robi?",odp:"drapanko",haslo:"Paczka 5020"},
{dzien:21,pytanie:"JakÄ… rasÄ™ psa chce kiedyÅ› mieÄ‡?",odp:"berneÅ„czyk",haslo:"Paczka 5022"},
{dzien:22,pytanie:"PamiÄ™tasz co Ci kiedyÅ› daÅ‚em na walentynki?",odp:"naszyjnik",haslo:"Paczka 0000 (wiem ze straci kolor ale bardzo ci sie podobaÅ‚ i chciaÅ‚em zebyÅ› znowu mogÅ‚a chwilÄ™ ponosiÄ‡ <3 )"},
{dzien:23,pytanie:"Co zawsze poprawia Ci humor?",odp:"przytulanie",haslo:"Paczka 6605"},
{dzien:24,pytanie:"Kim dla mnie jesteÅ›?(.10. i .8. .6. .5.)",odp:"narzeczonÄ… i miÅ‚oÅ›ciÄ… mojego Å¼ycia",haslo:"Paczka 1002"}
];

// GENEROWANIE DZIENNYCH BOXÃ“W
dane.forEach(d=>{
  const blok=document.createElement("div");
  blok.className="day-box";
  const dzienDzis=dzis.getDate();
  const miesiacDzis=dzis.getMonth()+1;
  let zablokowany = !(test || (miesiacDzis===12 && dzienDzis>=d.dzien));
  if(zablokowany) blok.classList.add("locked");
  blok.innerHTML=`<h2>âœ¨ DzieÅ„ ${d.dzien}</h2>
    <p>${zablokowany?"Odblokuje siÄ™ "+d.dzien+" grudnia ğŸ":d.pytanie}</p>
    ${zablokowany?"":`
      <input type='text' id='odp${d.dzien}' placeholder='Twoja odpowiedÅº' />
      <button onclick='sprawdz(${d.dzien})'>SprawdÅº</button>
      <p id='wynik${d.dzien}' class='password'></p>
      <p>OceÅ„ prezent ğŸ:</p>
      <div class='rating' data-dzien='${d.dzien}'>
        <span class='star' data-value='1'>â˜…</span>
        <span class='star' data-value='2'>â˜…</span>
        <span class='star' data-value='3'>â˜…</span>
        <span class='star' data-value='4'>â˜…</span>
        <span class='star' data-value='5'>â˜…</span>
      </div>
      <button onclick='wyslijOcene(${d.dzien})'>WyÅ›lij ocenÄ™</button>
      <p id='statusOcena${d.dzien}'></p>
    `}
  `;
  document.body.appendChild(blok);
});

// SPRAWDZANIE ODPOWIEDZI
function sprawdz(dzien){
  const wpis=document.getElementById("odp"+dzien).value.toLowerCase().trim();
  const poprawna=dane.find(x=>x.dzien===dzien).odp;
  const wynik=document.getElementById("wynik"+dzien);
  if(wpis===poprawna){wynik.textContent=dane.find(x=>x.dzien===dzien).haslo+" ğŸ"; wynik.style.color="green";}
  else{wynik.textContent="Niepoprawna odpowiedÅº âŒ"; wynik.style.color="red";}
}

// GWIAZDKI
document.addEventListener("click",e=>{
  if(e.target.classList.contains("star")){
    const star=e.target; const value=star.dataset.value; const ratingDiv=star.parentElement; const dzien=ratingDiv.dataset.dzien;
    wybraneOceny[dzien]=value;
    [...ratingDiv.children].forEach(s=>s.classList.toggle("selected",s.dataset.value<=value));
  }
});
  
  function ocenyCallback(oceny) {
  for (const dzien in oceny) {
    const ratingDiv = document.querySelector(`.rating[data-dzien='${dzien}']`);
    if (!ratingDiv) continue;
    
    const value = oceny[dzien];
    [...ratingDiv.children].forEach(star => {
      star.classList.toggle("selected", star.dataset.value <= value);
    });
    wybraneOceny[dzien] = value; // aktualizacja lokalnie
  }
}

// WywoÅ‚anie podczas Å‚adowania strony
const script = document.createElement("script");
script.src = "https://script.google.com/macros/s/AKfycbwOghPZn8QE1F2Cnrn8tdWf6Nxw3MpMQ5oiGR7iEeu9NnRs3RWSJIp97pneWrur3JJFQQ/exec?callback=ocenyCallback";
document.body.appendChild(script);


// JSONP - wysyÅ‚anie ocen
function wyslijOcene(dzien){
  const ocena=wybraneOceny[dzien];
  const status=document.getElementById("statusOcena"+dzien);
  if(!ocena){status.textContent="Najpierw wybierz gwiazdki â­!"; status.style.color="red"; return;}
  const callbackName='jsonpCallback'+dzien;
  window[callbackName]=function(data){
    if(data.status==="OK"){
      status.textContent="Ocena zapisana! â¤ï¸";
      document.querySelector(`.rating[data-dzien='${dzien}']`).style.pointerEvents="none";
    }
  };
  const script=document.createElement('script');
  script.src=`${sheetURL}?dzien=${dzien}&ocena=${ocena}&callback=${callbackName}`;
  document.body.appendChild(script);
}

// ANIMACJA ÅšNIEGU I SERDECZEK
function snowHeart() {
  for(let i=0;i<10;i++){
    const s=document.createElement('div');
    s.className=Math.random()>0.8?'heart':'snowflake';
    s.textContent=s.className==='heart'?'â¤ï¸':'â„';
    s.style.left=Math.random()*100+'%';
    s.style.fontSize=(Math.random()*15+10)+'px';
    s.style.animationDuration=(Math.random()*5+5)+'s';
    document.body.appendChild(s);
    setTimeout(()=>s.remove(),10000);
  }
}
setInterval(snowHeart,1000);

</script>
</body>
</html>
