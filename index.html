<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kalendarz Adwentowy ‚Äì Quiz</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(#ffefef, #ffeaea);
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow-x: hidden;
    }
    h1 {
      color: #d62828;
      margin-bottom: 10px;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    .day-box {
      width: 90%;
      max-width: 600px;
      background: white;
      padding: 20px;
      margin: 15px 0;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0,0,0,0.15);
      position: relative;
      overflow: hidden;
    }
    .locked {
      opacity: 0.5;
      pointer-events: none;
    }
    button {
      margin-top: 10px;
      padding: 8px 14px;
      border: none;
      background: #d62828;
      color: white;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background: #a71c1c;
    }
    .password {
      margin-top: 10px;
      font-weight: bold;
      color: green;
    }

    /* Falling snow */
    .snowflake {
      position: fixed;
      top: -10px;
      color: white;
      font-size: 1.2em;
      animation: fall linear infinite;
    }
    @keyframes fall {
      0% { transform: translateY(0); opacity: 1; }
      100% { transform: translateY(100vh); opacity: 0; }
    }

    .rating {
      display: flex;
      gap: 5px;
      font-size: 26px;
      cursor: pointer;
      user-select: none;
      margin-top: 10px;
    }
    .star {
      color: #ccc;
      transition: color 0.2s;
    }
    .star:hover,
    .star:hover ~ .star {
      color: #ccc;
    }
    .rating:hover .star {
      color: gold;
    }
    .rating .star:hover ~ .star {
      color: #ccc;
    }
    .star.selected {
      color: gold;
    }
  </style>
</head>
<body>
  <h1>üéÑ Adwentowy Quiz dla Alicji ‚ù§Ô∏è</h1>
  <p>Odpowiedz na pytanie dnia, aby dostaƒá has≈Ço (numer paczki) üéÅ</p>
  <p>Musisz pr√≥bowaƒá r√≥≈ºnych kombinacji, dla u≈Çatwienia wszystko z ma≈Çych liter</p>
  <p>PRZEPRASZAM za moje umiejƒôtno≈õci pakowania</p>

  <script>
    const params = new URLSearchParams(window.location.search);
    const test = params.get('test');
    const dzis = test ? new Date(2025, 11, 25) : new Date();

    const dane = [
      {dzien:1,pytanie:"TWOJ Najlepszy nap√≥j gazowany?",odp:"cola zero",haslo:"Paczka 1602"},
      {dzien:2,pytanie:"Jakim pieszczotliwym okre≈õleniem najczƒô≈õciej Ciƒô nazywam?",odp:"≈ºuczku",haslo:"Paczka 5100"},
      {dzien:3,pytanie:"Gdzie sie poznali≈õmy?",odp:"szko≈Ça muzyczna",haslo:"Paczka 5118"},
      {dzien:4,pytanie:"Jakiego psa chcesz kiedy≈õ mieƒá?",odp:"par√≥wa",haslo:"Paczka 0020"},
      {dzien:5,pytanie:"Jaki kolor oczu chcia≈Çaby≈õ ≈ºeby mia≈Ç tw√≥j ch≈Çopak?",odp:"niebieski",haslo:"Paczka 0005"},
      // ... reszta pyta≈Ñ ...
      {dzien:24,pytanie:"Kim dla mnie jeste≈õ?(... i ... ... ..)",odp:"narzeczonƒÖ i mi≈Ço≈õciƒÖ mojego ≈ºycia",haslo:"Paczka 6605"}
    ];

    let wybraneOceny = {};

    dane.forEach(d => {
      const blok = document.createElement("div");
      blok.className = "day-box";

      const dzienDzis = dzis.getDate();
      const miesiacDzis = dzis.getMonth() + 1;

      let zablokowany = !(miesiacDzis === 12 && dzienDzis >= d.dzien);
      if (zablokowany) blok.classList.add("locked");

      blok.innerHTML = `
        <h2>‚ú® Dzie≈Ñ ${d.dzien}</h2>
        <p>${zablokowany ? "Odblokuje siƒô " + d.dzien + " grudnia üéÅ" : d.pytanie}</p>
        ${zablokowany ? "" : `
          <input type='text' id='odp${d.dzien}' placeholder='Twoja odpowied≈∫' />
          <button onclick='sprawdz(${d.dzien})'>Sprawd≈∫</button>
          <p id='wynik${d.dzien}' class='password'></p>
          <p>Oce≈Ñ prezent üéÅ:</p>
          <div class='rating' data-dzien='${d.dzien}'>
            <span class='star' data-value='1'>‚òÖ</span>
            <span class='star' data-value='2'>‚òÖ</span>
            <span class='star' data-value='3'>‚òÖ</span>
            <span class='star' data-value='4'>‚òÖ</span>
            <span class='star' data-value='5'>‚òÖ</span>
          </div>
          <button onclick='wyslijOcene(${d.dzien})'>Wy≈õlij ocenƒô</button>
          <p id='statusOcena${d.dzien}'></p>
        `}
      `;
      document.body.appendChild(blok);
    });

    function sprawdz(dzien) {
      const wpis = document.getElementById("odp" + dzien).value.toLowerCase().trim();
      const poprawna = dane.find(x => x.dzien === dzien).odp;
      const wynik = document.getElementById("wynik" + dzien);

      if (wpis === poprawna) {
        wynik.textContent = dane.find(x => x.dzien === dzien).haslo + " üéÅ";
        wynik.style.color = "green";
      } else {
        wynik.textContent = "Niepoprawna odpowied≈∫ ‚ùå";
        wynik.style.color = "red";
      }
    }

    // Obs≈Çuga gwiazdek
    document.addEventListener("click", e => {
      if (e.target.classList.contains("star")) {
        const star = e.target;
        const value = star.dataset.value;
        const ratingDiv = star.parentElement;
        const dzien = ratingDiv.dataset.dzien;
        wybraneOceny[dzien] = value;
        [...ratingDiv.children].forEach(s => s.classList.toggle("selected", s.dataset.value <= value));
      }
    });

    function wyslijOcene(dzien) {
      const ocena = wybraneOceny[dzien];
      const status = document.getElementById("statusOcena" + dzien);
      if (!ocena) {
        status.textContent = "Najpierw wybierz liczbƒô gwiazdek ‚≠ê!";
        status.style.color = "red";
        return;
      }
      const sheetURL = "https://script.google.com/macros/s/AKfycbzaFTP1zEeXpCVd8JfwZYEi80a0K_4pmpsA8nwX85A_QGfmg4I6le4IWSRBVH770XQzOQ/exec";
      const url = `${sheetURL}?dzien=${dzien}&ocena=${ocena}`;

      fetch(url)
        .then(r => r.json())
        .then(data => {
          if (data.status === "OK") {
            status.textContent = "Ocena zapisana! ‚ù§Ô∏è";
            status.style.color = "green";
            document.querySelector(`.rating[data-dzien='${dzien}']`).style.pointerEvents = "none";
          } else {
            status.textContent = "B≈ÇƒÖd: " + data.message;
            status.style.color = "red";
          }
        })
        .catch(() => {
          status.textContent = "B≈ÇƒÖd ‚Äî spr√≥buj ponownie üò¢";
          status.style.color = "red";
        });
    }

    // ≈önieg
    function snow() {
      for (let i = 0; i < 15; i++) {
        const s = document.createElement("div");
        s.className = "snowflake";
        s.textContent = "‚ùÑ";
        s.style.left = Math.random() * 100 + "%";
        s.style.fontSize = (Math.random() * 15 + 10) + "px";
        s.style.animationDuration = (Math.random() * 5 + 5) + "s";
        document.body.appendChild(s);
        setTimeout(() => s.remove(), 10000);
      }
    }
    setInterval(snow, 1000);
  </script>
</body>
</html>
